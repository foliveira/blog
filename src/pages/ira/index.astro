---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("posts", ({ data }) => !data.draft)).sort(
    (a, b) => b.data.date.getTime() - a.data.date.getTime(),
);
---

<BaseLayout title="blahg" description="because blog was already taken">
    <section>
        <h1>Latest Posts</h1>
        <ul class="list">
            {
                posts.map((p) => (
                    <li class="list-item">
                        <div class="caps">
                            <time datetime={p.data.date.toISOString()}>
                                {p.data.date.toLocaleDateString(undefined, {
                                    year: "numeric",
                                    month: "short",
                                    day: "2-digit",
                                })}
                            </time>
                        </div>
                        <h3 style="margin:.25rem 0;">
                            <a href={`/ira/posts/${p.slug}`}>{p.data.title}</a>
                        </h3>
                        {p.data.description && (
                            <p class="muted" style="margin:.35rem 0 0;">
                                {p.data.description}
                            </p>
                        )}
                    </li>
                ))
            }
        </ul>
    </section>
</BaseLayout>
